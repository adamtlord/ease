{% extends 'base_app.html' %}
{% load custom_tags %}
{% load map_tags %}

{% block title %}Create an Account{% endblock title %}
{% block content %}

<div class="page-header">
    <h2>{% if self %}Where do you{% endif %}{% if lovedone %}Where does your loved one{% endif %} go most frequently?</h2>
</div>

<form action="" class="form add-destinations" method="POST" novalidate>{% csrf_token %}
    {% if errors %}
        {% if errors|length == 1 %}
            Please correct the error below.
        {% else %}
            Please correct the errors below.
        {% endif %}
        {{ home_form.non_field_errors }}
        {% for dict in destination_formset.errors %}
            {% for error in dict.values %}
                {{ error }}
            {% endfor %}
        {% endfor %}
    {% endif %}
    <div class="row">
        <div class="col-sm-4 col-sm-push-8">
            <h3>{% if self %}Your{% endif %}{% if lovedone %}{{ customer.first_name }}'s{% endif %} Home</h3>
            {{ home.street1 }}<br>
            {% if home.street2 %}
                {{ home.street2 }}<br>
            {% endif %}
            {{ home.city }},
            {{ home.state }}
            {{ home.zip_code }}
            {% static_map home %}
        </div>
        <div class="col-sm-8 col-sm-pull-4">
            <h3>{% if self %}Your{% endif %}{% if lovedone %}{{ customer.first_name }}'s{% endif %} Destinations</h3>
            {{ destination_formset.management_form }}
            {% for form in destination_formset.forms %}
                <fieldset class="destination">
                    {% render_form_field form.name %}
                    {% render_form_field form.nickname %}
                    {% render_form_field form.street1 %}
                    {% render_form_field form.street2 '', 'no-label' %}
                    {% render_form_field form.city %}
                    {% render_form_field form.state %}
                    {% render_form_field form.zip_code %}
                    {% for hidden in form.hidden_fields %}
                        {{ hidden }}
                    {% endfor %}
                </fieldset>
            {% endfor %}
            <div class="form-actions">
                <input type="submit" class="btn btn-primary" value="Save Destinations" />
            </div>
        </div>
    </div>
</form>
{% endblock %}